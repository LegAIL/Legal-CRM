exports.id=3216,exports.ids=[3216],exports.modules={7351:(e,s,a)=>{Promise.resolve().then(a.bind(a,99959)),Promise.resolve().then(a.bind(a,81766))},99959:(e,s,a)=>{"use strict";a.d(s,{CaseDetailView:()=>ep});var t=a(10326),l=a(17577),r=a(90772),i=a(33071),d=a(28407),n=a(77863);let c=d.fC,o=l.forwardRef(({className:e,...s},a)=>t.jsx(d.aV,{ref:a,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));o.displayName=d.aV.displayName;let m=l.forwardRef(({className:e,...s},a)=>t.jsx(d.xz,{ref:a,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));m.displayName=d.xz.displayName;let x=l.forwardRef(({className:e,...s},a)=>t.jsx(d.VY,{ref:a,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));x.displayName=d.VY.displayName;var h=a(567),u=a(60064),f=a(4150);let p=l.forwardRef(({className:e,...s},a)=>t.jsx(f.fC,{ref:a,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));p.displayName=f.fC.displayName;let j=l.forwardRef(({className:e,...s},a)=>t.jsx(f.Ee,{ref:a,className:(0,n.cn)("aspect-square h-full w-full",e),...s}));j.displayName=f.Ee.displayName;let g=l.forwardRef(({className:e,...s},a)=>t.jsx(f.NY,{ref:a,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));g.displayName=f.NY.displayName;var N=a(11890),v=a(24061),y=a(81538),b=a(66307),w=a(36283),k=a(8122),C=a(71739),S=a(28932),D=a(7027),Z=a(53982),R=a(37358),T=a(48998),$=a(40617),z=a(71821),E=a(90434),F=a(43686),A=a(62288),I=a(87673),_=a(53313),L=a(83855),O=a(35047),V=a(85999);function Y({caseId:e}){let[s,a]=(0,l.useState)(!1),[i,d]=(0,l.useState)(!1),[n,c]=(0,l.useState)(""),[o,m]=(0,l.useState)(!1),x=(0,O.useRouter)(),h=async s=>{if(s.preventDefault(),n.trim()){d(!0);try{if((await fetch(`/api/cases/${e}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n.trim(),isInternal:o})})).ok)c(""),m(!1),a(!1),x.refresh(),V.Am.success("Comment added successfully");else throw Error("Failed to add comment")}catch(e){V.Am.error("Failed to add comment")}finally{d(!1)}}};return(0,t.jsxs)(A.Vq,{open:s,onOpenChange:a,children:[t.jsx(A.hg,{asChild:!0,children:(0,t.jsxs)(r.z,{size:"sm",variant:"outline",children:[t.jsx(L.Z,{className:"w-4 h-4 mr-2"}),"Skriv meddelande"]})}),(0,t.jsxs)(A.cZ,{className:"max-w-md",children:[t.jsx(A.fK,{children:t.jsx(A.$N,{children:"Nytt meddelande i Case Chat"})}),(0,t.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[t.jsx("div",{children:t.jsx(I.g,{placeholder:"Skriv ditt meddelande...",value:n,onChange:e=>c(e.target.value),rows:4,required:!0,className:"resize-none"})}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(_.X,{id:"internal",checked:o,onCheckedChange:e=>m(e)}),t.jsx("label",{htmlFor:"internal",className:"text-sm text-muted-foreground",children:"Internt meddelande (ej synligt f\xf6r klient)"})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(r.z,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Avbryt"}),t.jsx(r.z,{type:"submit",disabled:i||!n.trim(),children:i?"Skickar...":"Skicka meddelande"})]})]})]})]})}var H=a(54432),P=a(31048);function U({caseId:e}){let[s,a]=(0,l.useState)(!1),[i,d]=(0,l.useState)(!1),[n,c]=(0,l.useState)({description:"",hours:"",date:new Date().toISOString().split("T")[0],billable:!0,hourlyRate:""}),o=(0,O.useRouter)(),m=async s=>{if(s.preventDefault(),!(!n.hours||0>=parseFloat(n.hours))){d(!0);try{if((await fetch(`/api/cases/${e}/time-entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:n.description.trim(),hours:parseFloat(n.hours),date:new Date(n.date).toISOString(),billable:n.billable,hourlyRate:n.hourlyRate?parseFloat(n.hourlyRate):null})})).ok)c({description:"",hours:"",date:new Date().toISOString().split("T")[0],billable:!0,hourlyRate:""}),a(!1),o.refresh(),V.Am.success("Time entry added successfully");else throw Error("Failed to add time entry")}catch(e){V.Am.error("Failed to add time entry")}finally{d(!1)}}};return(0,t.jsxs)(A.Vq,{open:s,onOpenChange:a,children:[t.jsx(A.hg,{asChild:!0,children:(0,t.jsxs)(r.z,{children:[t.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Log Time"]})}),(0,t.jsxs)(A.cZ,{children:[t.jsx(A.fK,{children:t.jsx(A.$N,{children:"Log Time Entry"})}),(0,t.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"date",children:"Date"}),t.jsx(H.I,{id:"date",type:"date",value:n.date,onChange:e=>c(s=>({...s,date:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"hours",children:"Hours"}),t.jsx(H.I,{id:"hours",type:"number",step:"0.25",min:"0.25",placeholder:"1.5",value:n.hours,onChange:e=>c(s=>({...s,hours:e.target.value})),required:!0})]})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"description",children:"Description"}),t.jsx(I.g,{id:"description",placeholder:"What did you work on?",value:n.description,onChange:e=>c(s=>({...s,description:e.target.value})),rows:3})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"hourlyRate",children:"Hourly Rate ($)"}),t.jsx(H.I,{id:"hourlyRate",type:"number",step:"0.01",min:"0",placeholder:"150.00",value:n.hourlyRate,onChange:e=>c(s=>({...s,hourlyRate:e.target.value}))})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(_.X,{id:"billable",checked:n.billable,onCheckedChange:e=>c(s=>({...s,billable:e}))}),t.jsx(P._,{htmlFor:"billable",className:"text-sm",children:"Billable time"})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(r.z,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),t.jsx(r.z,{type:"submit",disabled:i||!n.hours,children:"Log Time"})]})]})]})]})}var W=a(34474);function B({caseId:e}){let[s,a]=(0,l.useState)(!1),[i,d]=(0,l.useState)(!1),[n,c]=(0,l.useState)({type:"statute",title:"",citation:"",url:"",summary:"",relevance:""}),o=(0,O.useRouter)(),m=async s=>{if(s.preventDefault(),n.title.trim()&&n.citation.trim()){d(!0);try{if((await fetch(`/api/cases/${e}/legal-references`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:n.type,title:n.title.trim(),citation:n.citation.trim(),url:n.url.trim()||null,summary:n.summary.trim()||null,relevance:n.relevance.trim()||null})})).ok)c({type:"statute",title:"",citation:"",url:"",summary:"",relevance:""}),a(!1),o.refresh(),V.Am.success("Legal reference added successfully");else throw Error("Failed to add legal reference")}catch(e){V.Am.error("Failed to add legal reference")}finally{d(!1)}}};return(0,t.jsxs)(A.Vq,{open:s,onOpenChange:a,children:[t.jsx(A.hg,{asChild:!0,children:(0,t.jsxs)(r.z,{children:[t.jsx(C.Z,{className:"w-4 h-4 mr-2"}),"Add Legal Reference"]})}),(0,t.jsxs)(A.cZ,{className:"max-w-2xl",children:[t.jsx(A.fK,{children:t.jsx(A.$N,{children:"Add Legal Reference"})}),(0,t.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"type",children:"Type"}),(0,t.jsxs)(W.Ph,{value:n.type,onValueChange:e=>c(s=>({...s,type:e})),children:[t.jsx(W.i4,{children:t.jsx(W.ki,{})}),(0,t.jsxs)(W.Bw,{children:[t.jsx(W.Ql,{value:"statute",children:"Statute"}),t.jsx(W.Ql,{value:"case_law",children:"Case Law"}),t.jsx(W.Ql,{value:"regulation",children:"Regulation"}),t.jsx(W.Ql,{value:"article",children:"Legal Article"}),t.jsx(W.Ql,{value:"other",children:"Other"})]})]})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"title",children:"Title"}),t.jsx(H.I,{id:"title",placeholder:"e.g., Smith v. Johnson",value:n.title,onChange:e=>c(s=>({...s,title:e.target.value})),required:!0})]})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"citation",children:"Citation"}),t.jsx(H.I,{id:"citation",placeholder:"e.g., 123 F.3d 456 (9th Cir. 2023)",value:n.citation,onChange:e=>c(s=>({...s,citation:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"url",children:"URL (Optional)"}),t.jsx(H.I,{id:"url",type:"url",placeholder:"https://...",value:n.url,onChange:e=>c(s=>({...s,url:e.target.value}))})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"summary",children:"Summary"}),t.jsx(I.g,{id:"summary",placeholder:"Brief summary of the legal principle or holding...",value:n.summary,onChange:e=>c(s=>({...s,summary:e.target.value})),rows:3})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"relevance",children:"Relevance to Case"}),t.jsx(I.g,{id:"relevance",placeholder:"How does this reference apply to our case?...",value:n.relevance,onChange:e=>c(s=>({...s,relevance:e.target.value})),rows:2})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(r.z,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),t.jsx(r.z,{type:"submit",disabled:i||!n.title.trim()||!n.citation.trim(),children:"Add Reference"})]})]})]})]})}var q=a(80440);let Q=q.fC,M=q.xz,G=q.h_,J=l.forwardRef(({className:e,...s},a)=>t.jsx(q.aV,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:a}));J.displayName=q.aV.displayName;let K=l.forwardRef(({className:e,...s},a)=>(0,t.jsxs)(G,{children:[t.jsx(J,{}),t.jsx(q.VY,{ref:a,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));K.displayName=q.VY.displayName;let X=({className:e,...s})=>t.jsx("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...s});X.displayName="AlertDialogHeader";let ee=({className:e,...s})=>t.jsx("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});ee.displayName="AlertDialogFooter";let es=l.forwardRef(({className:e,...s},a)=>t.jsx(q.Dx,{ref:a,className:(0,n.cn)("text-lg font-semibold",e),...s}));es.displayName=q.Dx.displayName;let ea=l.forwardRef(({className:e,...s},a)=>t.jsx(q.dk,{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...s}));ea.displayName=q.dk.displayName;let et=l.forwardRef(({className:e,...s},a)=>t.jsx(q.aU,{ref:a,className:(0,n.cn)((0,r.d)(),e),...s}));et.displayName=q.aU.displayName;let el=l.forwardRef(({className:e,...s},a)=>t.jsx(q.$j,{ref:a,className:(0,n.cn)((0,r.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));el.displayName=q.$j.displayName;var er=a(45480),ei=a(98091),ed=a(53468),en=a(40815),ec=a(77197),eo=a(82616);function em({step:e,index:s,caseId:a,onToggle:l,onDelete:d,getUserDisplayName:n}){let{attributes:c,listeners:o,setNodeRef:m,transform:x,transition:u,isDragging:f}=(0,ec.nB)({id:e.id}),N={transform:eo.ux.Transform.toString(x),transition:u,opacity:f?.5:1};return(0,t.jsxs)("div",{ref:m,style:N,className:"relative flex items-start gap-4 group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:t.jsx("span",{className:"text-sm font-semibold text-primary",children:s+1})}),t.jsx("div",{...c,...o,className:"cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx(er.Z,{className:"w-4 h-4 text-muted-foreground"})}),t.jsx("button",{onClick:()=>l(e.id),className:`w-6 h-6 rounded-full flex items-center justify-center transition-colors ${e.completed?"bg-green-500 hover:bg-green-600":"bg-border hover:bg-border/80"}`,children:e.completed?t.jsx(b.Z,{className:"w-4 h-4 text-white"}):t.jsx(Z.Z,{className:"w-4 h-4 text-muted-foreground"})})]}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(i.Zb,{className:`${e.completed?"opacity-75":""} hover:shadow-md transition-shadow`,children:(0,t.jsxs)(i.aY,{className:"pt-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[t.jsx("h3",{className:`font-semibold ${e.completed?"line-through text-muted-foreground":"text-foreground"}`,children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.completed&&e.completedAt&&(0,t.jsxs)(h.C,{variant:"outline",className:"text-xs",children:[t.jsx(b.Z,{className:"w-3 h-3 mr-1"}),"Completed ",(0,F.Q)(new Date(e.completedAt),{addSuffix:!0})]}),(0,t.jsxs)(Q,{children:[t.jsx(M,{asChild:!0,children:t.jsx(r.z,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity text-destructive hover:text-destructive",children:t.jsx(ei.Z,{className:"h-4 w-4"})})}),(0,t.jsxs)(K,{children:[(0,t.jsxs)(X,{children:[t.jsx(es,{children:"Ta bort workflow-steg"}),(0,t.jsxs)(ea,{children:['\xc4r du s\xe4ker p\xe5 att du vill ta bort steget "',e.title,'"? Denna \xe5tg\xe4rd kan inte \xe5ngras.']})]}),(0,t.jsxs)(ee,{children:[t.jsx(el,{children:"Avbryt"}),t.jsx(et,{onClick:()=>d(e.id),className:"bg-destructive hover:bg-destructive/90",children:"Ta bort"})]})]})]})]})]}),e.description&&t.jsx("p",{className:`text-sm mb-3 ${e.completed?"text-muted-foreground":""}`,children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground flex-wrap",children:[e.assignedTo&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(p,{className:"w-4 h-4",children:[t.jsx(j,{src:e.assignedTo.image||""}),t.jsx(g,{className:"text-xs",children:n(e.assignedTo).slice(0,2).toUpperCase()})]}),t.jsx("span",{children:n(e.assignedTo)})]}),e.estimatedHours&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[t.jsx(T.Z,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:[e.estimatedHours,"h estimated"]})]}),e.dueDate&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[t.jsx(R.Z,{className:"w-3 h-3"}),t.jsx("span",{className:new Date(e.dueDate)<new Date&&!e.completed?"text-red-500 font-medium":"",children:new Date(e.dueDate).toLocaleDateString("sv-SE")})]})]})]})})})]})}function ex({caseId:e,users:s}){let[a,i]=(0,l.useState)(!1),[d,n]=(0,l.useState)(!1),[c,o]=(0,l.useState)({title:"",description:"",assignedToId:"",estimatedHours:"",dueDate:""}),m=(0,O.useRouter)(),x=async s=>{if(s.preventDefault(),c.title.trim()){n(!0);try{if((await fetch(`/api/cases/${e}/workflow-steps`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c.title.trim(),description:c.description.trim()||null,assignedToId:c.assignedToId||null,estimatedHours:c.estimatedHours?parseFloat(c.estimatedHours):null,dueDate:c.dueDate?new Date(c.dueDate).toISOString():null})})).ok)o({title:"",description:"",assignedToId:"",estimatedHours:"",dueDate:""}),i(!1),m.refresh(),V.Am.success("Workflow step added successfully");else throw Error("Failed to add workflow step")}catch(e){V.Am.error("Failed to add workflow step")}finally{n(!1)}}},h=e=>e?.name||`${e?.firstName||""} ${e?.lastName||""}`.trim()||e?.email||"Unknown";return(0,t.jsxs)(A.Vq,{open:a,onOpenChange:i,children:[t.jsx(A.hg,{asChild:!0,children:(0,t.jsxs)(r.z,{children:[t.jsx(L.Z,{className:"w-4 h-4 mr-2"}),"Add Step"]})}),(0,t.jsxs)(A.cZ,{className:"max-w-md",children:[t.jsx(A.fK,{children:t.jsx(A.$N,{children:"Add Workflow Step"})}),(0,t.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"title",children:"Title *"}),t.jsx(H.I,{id:"title",value:c.title,onChange:e=>o(s=>({...s,title:e.target.value})),placeholder:"e.g., Client consultation, File documents",required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"description",children:"Description"}),t.jsx(I.g,{id:"description",value:c.description,onChange:e=>o(s=>({...s,description:e.target.value})),placeholder:"Detailed description of what needs to be done...",rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"assignedTo",children:"Assign to"}),(0,t.jsxs)(W.Ph,{value:c.assignedToId||"unassigned",onValueChange:e=>o(s=>({...s,assignedToId:"unassigned"===e?"":e})),children:[t.jsx(W.i4,{children:t.jsx(W.ki,{placeholder:"Select person"})}),(0,t.jsxs)(W.Bw,{children:[t.jsx(W.Ql,{value:"unassigned",children:"Unassigned"}),s?.map(e=>t.jsx(W.Ql,{value:e.id,children:h(e)},e.id))]})]})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"estimatedHours",children:"Est. Hours"}),t.jsx(H.I,{id:"estimatedHours",type:"number",step:"0.25",min:"0",value:c.estimatedHours,onChange:e=>o(s=>({...s,estimatedHours:e.target.value})),placeholder:"2.5"})]})]}),(0,t.jsxs)("div",{children:[t.jsx(P._,{htmlFor:"dueDate",children:"Due Date"}),t.jsx(H.I,{id:"dueDate",type:"date",value:c.dueDate,onChange:e=>o(s=>({...s,dueDate:e.target.value}))})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(r.z,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),t.jsx(r.z,{type:"submit",disabled:d||!c.title.trim(),children:d?"Adding...":"Add Step"})]})]})]})]})}function eh({caseId:e,steps:s,users:a,currentUser:r}){let d=(0,O.useRouter)(),[n,c]=(0,l.useState)(s),o=(0,en.Dy)((0,en.VT)(en.we),(0,en.VT)(en.Lg,{coordinateGetter:ec.is})),m=n.filter(e=>e.completed).length,x=n.length,h=x>0?m/x*100:0,f=e=>e?.name||`${e?.firstName||""} ${e?.lastName||""}`.trim()||e?.email||"Unknown",p=async a=>{let{active:t,over:l}=a;if(!l||t.id===l.id)return;let r=n.findIndex(e=>e.id===t.id),i=n.findIndex(e=>e.id===l.id),o=(0,ec.Rp)(n,r,i);c(o);try{if((await fetch(`/api/cases/${e}/workflow-steps/reorder`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({stepIds:o.map(e=>e.id)})})).ok)d.refresh(),V.Am.success("Workflow order updated");else throw Error("Failed to update order")}catch(e){c(s),V.Am.error("Failed to update workflow order")}},j=async s=>{try{if((await fetch(`/api/cases/${e}/workflow-steps/${s}/toggle`,{method:"POST"})).ok)d.refresh(),V.Am.success("Step updated");else throw Error("Failed to toggle step")}catch(e){V.Am.error("Failed to update step")}},g=async s=>{try{if((await fetch(`/api/cases/${e}/workflow-steps/${s}`,{method:"DELETE"})).ok)d.refresh(),V.Am.success("Step deleted");else throw Error("Failed to delete step")}catch(e){V.Am.error("Failed to delete step")}};return 0===x?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Case Workflow & Steps"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage workflow steps and track progress through key legal process stages"})]}),t.jsx(ex,{caseId:e,users:a})]}),t.jsx(i.Zb,{children:(0,t.jsxs)(i.aY,{className:"flex flex-col items-center justify-center py-16",children:[t.jsx(ed.Z,{className:"w-16 h-16 text-muted-foreground mb-4"}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Workflow Steps Defined"}),t.jsx("p",{className:"text-muted-foreground mb-4 text-center",children:"Start by adding workflow steps to organize and track the progress of this case."}),t.jsx(ex,{caseId:e,users:a})]})})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Case Workflow & Steps"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage workflow steps and track progress through key legal process stages"})]}),t.jsx(ex,{caseId:e,users:a})]}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[t.jsx("h3",{className:"font-semibold",children:"Workflow Progress"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[m," of ",x," steps completed"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-primary",children:[Math.round(h),"%"]}),t.jsx(u.Progress,{value:h,className:"w-24 mt-1"})]})]})})}),(0,t.jsxs)(i.Zb,{children:[t.jsx(i.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[t.jsx(ed.Z,{className:"h-5 w-5"}),"Workflow Steps (",x,")"]}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Drag steps to reorder • Click circles to toggle completion"})]})}),t.jsx(i.aY,{children:t.jsx(en.LB,{sensors:o,collisionDetection:en.pE,onDragEnd:p,children:t.jsx(ec.Fo,{items:n.map(e=>e.id),strategy:ec.qw,children:t.jsx("div",{className:"space-y-4",children:n.map((s,a)=>t.jsx(em,{step:s,index:a,caseId:e,onToggle:j,onDelete:g,getUserDisplayName:f},s.id))})})})})]})]})}let eu={NEW:"bg-blue-500",IN_PROGRESS:"bg-yellow-500",REVIEW:"bg-purple-500",COMPLETED:"bg-green-500"},ef={LOW:"bg-green-600",MEDIUM:"bg-yellow-600",HIGH:"bg-orange-600",URGENT:"bg-red-600"};function ep({caseData:e,currentUser:s,users:a}){let[d,n]=(0,l.useState)("overview"),f=e.timeEntries.filter(e=>e.billable).reduce((e,s)=>e+(s.amount||0),0),A=(e.workflowSteps||[]).filter(e=>e.completed).length,I=(e.workflowSteps||[]).length,_=(e.milestones||[]).filter(e=>e.completed).length,L=(e.milestones||[]).length;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx(E.default,{href:"/cases",children:(0,t.jsxs)(r.z,{variant:"outline",size:"sm",className:"mb-4",children:[t.jsx(N.Z,{className:"w-4 h-4 mr-2"}),"Back to Cases"]})}),(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx(h.C,{className:eu[e.status],children:e.status.replace("_"," ")}),(0,t.jsxs)(h.C,{variant:"outline",className:ef[e.priority],children:[e.priority," Priority"]}),(0,t.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[t.jsx(v.Z,{className:"w-4 h-4 mr-1"}),e.assignedTo?.name||"Unassigned"]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold law-gold",children:["$",f.toLocaleString()]}),t.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Billable"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[e.progress,"%"]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Progress"})]}),t.jsx(u.Progress,{value:e.progress,className:"w-16"})]})})}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[e.actualHours.toFixed(1),"h"]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Hours Logged"})]}),t.jsx(y.Z,{className:"w-8 h-8 text-muted-foreground"})]})})}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[_,"/",L]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Milestones"})]}),t.jsx(b.Z,{className:"w-8 h-8 text-muted-foreground"})]})})}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-2xl font-bold",children:e.files.length}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Documents"})]}),t.jsx(w.Z,{className:"w-8 h-8 text-muted-foreground"})]})})})]})]}),(0,t.jsxs)(c,{value:d,onValueChange:n,className:"w-full",children:[(0,t.jsxs)(o,{className:"grid w-full grid-cols-6",children:[t.jsx(m,{value:"overview",onClick:()=>n("overview"),children:"Overview"}),t.jsx(m,{value:"milestones",onClick:()=>n("milestones"),children:"Workflow"}),t.jsx(m,{value:"documents",onClick:()=>n("documents"),children:"Documents"}),t.jsx(m,{value:"time",onClick:()=>n("time"),children:"Time Tracking"}),t.jsx(m,{value:"legal",onClick:()=>n("legal"),children:"Legal Research"}),t.jsx(m,{value:"activity",onClick:()=>n("activity"),children:"Activity"})]}),t.jsx(x,{value:"overview",className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(i.Zb,{className:"lg:col-span-2",children:[t.jsx(i.Ol,{children:t.jsx(i.ll,{children:"\xc4rendedetaljer"})}),(0,t.jsxs)(i.aY,{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[t.jsx(w.Z,{className:"h-4 w-4"}),"Beskrivning"]}),t.jsx("p",{className:"text-muted-foreground bg-muted p-3 rounded-md",children:e.description||"Ingen beskrivning tillg\xe4nglig"})]}),e.clientName&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[t.jsx(v.Z,{className:"h-4 w-4"}),"Klientinformation"]}),(0,t.jsxs)("div",{className:"bg-muted p-3 rounded-md space-y-2",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Namn:"})," ",e.clientName]}),e.clientEmail&&(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"E-post:"}),t.jsx("a",{href:`mailto:${e.clientEmail}`,className:"text-blue-600 hover:underline ml-1",children:e.clientEmail})]})]}),e.clientPhone&&(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Telefon:"}),t.jsx("a",{href:`tel:${e.clientPhone}`,className:"text-blue-600 hover:underline ml-1",children:e.clientPhone})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[t.jsx(k.Z,{className:"h-4 w-4"}),"\xc4rendeinformation"]}),t.jsx("div",{className:"bg-muted p-3 rounded-md",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Skapades:"})," ",new Date(e.createdAt).toLocaleDateString("sv-SE")]}),(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Skapad av:"})," ",e.createdBy.name]}),e.dueDate&&(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Slutdatum:"}),t.jsx("span",{className:`ml-1 ${new Date(e.dueDate)<new Date?"text-red-600 font-semibold":""}`,children:new Date(e.dueDate).toLocaleDateString("sv-SE")})]}),(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Ansvarig:"})," ",e.assignedTo?.name||"Ej tilldelad"]}),e.estimatedHours&&(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Uppskattade timmar:"})," ",e.estimatedHours,"h"]}),e.hourlyRate&&(0,t.jsxs)("p",{children:[t.jsx("span",{className:"font-medium",children:"Timtariff:"})," $",e.hourlyRate.toLocaleString()]})]})})]}),e.tags.length>0&&(0,t.jsxs)("div",{children:[t.jsx("h4",{className:"font-semibold mb-2",children:"Taggar"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.tags.map((e,s)=>t.jsx(h.C,{variant:"secondary",className:"text-xs",children:e},s))})]}),e.legalStatutes&&e.legalStatutes.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[t.jsx(C.Z,{className:"h-4 w-4"}),"Till\xe4mpliga Lagrum"]}),t.jsx("div",{className:"space-y-3",children:e.legalStatutes.map(e=>(0,t.jsxs)(i.Zb,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(h.C,{variant:"outline",className:"text-xs",children:e.priority||"MEDIUM"}),t.jsx(h.C,{variant:"REVIEWED"===e.status?"default":"secondary",className:"text-xs",children:"TO_REVIEW"===e.status?"Ska granskas":"REVIEWED"===e.status?"Granskad":"Ej till\xe4mplig"})]}),e.url&&t.jsx(r.z,{variant:"outline",size:"sm",asChild:!0,children:t.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs",children:"Visa lagtext"})})]}),(0,t.jsxs)("h5",{className:"font-medium text-sm mb-1",children:[e.title,e.chapter&&` - ${e.chapter}`,e.section&&` ${e.section}`]}),e.description&&t.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.description}),e.notes&&(0,t.jsxs)("div",{className:"bg-blue-50 p-2 rounded text-xs",children:[t.jsx("span",{className:"font-medium",children:"Anteckningar f\xf6r detta \xe4rende:"})," ",e.notes]})]},e.id))})]}),(()=>{let s=e.activities?.find(e=>"drive_links_added"===e.type&&e.metadata?.driveLinks),a=s?.metadata?.driveLinks||[];return a.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[t.jsx(S.Z,{className:"h-4 w-4"}),"Google Drive & Dokument"]}),t.jsx("div",{className:"space-y-3",children:a.map((e,s)=>(0,t.jsxs)(i.Zb,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(h.C,{variant:"outline",className:"text-xs flex items-center gap-1",children:"folder"===e.type?(0,t.jsxs)(t.Fragment,{children:[t.jsx(S.Z,{className:"h-3 w-3"}),"Mapp"]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(w.Z,{className:"h-3 w-3"}),"Dokument"]})})}),t.jsx(r.z,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs",children:[t.jsx(D.Z,{className:"h-3 w-3 mr-1"}),"\xd6ppna"]})})]}),t.jsx("h5",{className:"font-medium text-sm mb-1",children:e.name}),e.description&&t.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]},s))})]})})(),e.notes&&(0,t.jsxs)("div",{children:[t.jsx("h4",{className:"font-semibold mb-2",children:"\xd6vriga anteckningar"}),t.jsx("div",{className:"bg-amber-50 p-3 rounded-md border-l-4 border-amber-400",children:t.jsx("p",{className:"text-sm",children:e.notes})})]})]})]}),(0,t.jsxs)(i.Zb,{children:[t.jsx(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[t.jsx(b.Z,{className:"h-5 w-5"}),"Workflow & Framsteg"]})}),t.jsx(i.aY,{children:e.workflowSteps&&e.workflowSteps.length>0?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[A," av ",I," steg slutf\xf6rda"]}),t.jsx(u.Progress,{value:I>0?A/I*100:0,className:"w-24"})]}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:e.workflowSteps.slice(0,5).map((s,a)=>(0,t.jsxs)("div",{className:"flex items-start gap-3 p-2 rounded border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-primary/10 flex items-center justify-center",children:t.jsx("span",{className:"text-xs font-semibold text-primary",children:a+1})}),t.jsx("button",{onClick:async()=>{try{(await fetch(`/api/cases/${e.id}/workflow-steps/${s.id}/toggle`,{method:"POST"})).ok&&window.location.reload()}catch(e){console.error("Failed to toggle step:",e)}},className:`w-4 h-4 rounded-full flex items-center justify-center transition-colors ${s.completed?"bg-green-500 hover:bg-green-600":"bg-border hover:bg-border/80"}`,children:s.completed?t.jsx(b.Z,{className:"w-3 h-3 text-white"}):t.jsx(Z.Z,{className:"w-3 h-3 text-muted-foreground"})})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("h5",{className:`text-sm font-medium ${s.completed?"line-through text-muted-foreground":""}`,children:s.title}),s.description&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:s.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-xs text-muted-foreground",children:[s.dueDate&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[t.jsx(R.Z,{className:"w-3 h-3"}),new Date(s.dueDate).toLocaleDateString("sv-SE")]}),s.estimatedHours&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[t.jsx(T.Z,{className:"w-3 h-3"}),s.estimatedHours,"h"]}),s.assignedTo&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[t.jsx(v.Z,{className:"w-3 h-3"}),s.assignedTo.name||`${s.assignedTo.firstName} ${s.assignedTo.lastName}`.trim()]})]})]})]},s.id))}),e.workflowSteps.length>5&&t.jsx("div",{className:"text-center",children:(0,t.jsxs)(r.z,{variant:"outline",size:"sm",onClick:()=>n("milestones"),children:["Se alla ",e.workflowSteps.length," steg"]})})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(b.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Inga workflow-steg definierade \xe4nnu"}),t.jsx("p",{className:"text-sm",children:"L\xe4gg till workflow-steg f\xf6r att sp\xe5ra framstegen"})]})})]}),(0,t.jsxs)(i.Zb,{children:[t.jsx(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx($.Z,{className:"h-5 w-5"}),"Case Chat"]}),t.jsx(Y,{caseId:e.id})]})}),t.jsx(i.aY,{className:"p-0",children:t.jsx("div",{className:"flex flex-col h-96",children:t.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:0===e.comments.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[t.jsx($.Z,{className:"h-12 w-12 mb-4 opacity-50"}),t.jsx("p",{children:"Ingen diskussion \xe4nnu"}),t.jsx("p",{className:"text-sm",children:"Starta konversationen om detta \xe4rende"})]}):e.comments.map(e=>{let a=e.author.id===s.id;return(0,t.jsxs)("div",{className:`flex gap-3 ${a?"flex-row-reverse":""}`,children:[(0,t.jsxs)(p,{className:"w-8 h-8 mt-1",children:[t.jsx(j,{src:e.author.image||""}),t.jsx(g,{className:"text-xs",children:e.author.name?.split(" ").map(e=>e[0]).join("").toUpperCase()})]}),t.jsx("div",{className:`flex-1 max-w-[75%] ${a?"items-end":""}`,children:(0,t.jsxs)("div",{className:`rounded-lg p-3 ${a?"bg-primary text-primary-foreground ml-auto":"bg-muted"}`,children:[(0,t.jsxs)("div",{className:`flex items-center gap-2 mb-1 ${a?"justify-end":""}`,children:[t.jsx("span",{className:"font-medium text-xs",children:a?"Du":e.author.name}),t.jsx("span",{className:`text-xs ${a?"text-primary-foreground/70":"text-muted-foreground"}`,children:(0,F.Q)(new Date(e.createdAt),{addSuffix:!0})}),e.isInternal&&t.jsx(h.C,{variant:a?"outline":"secondary",className:"text-xs",children:"Internt"})]}),t.jsx("p",{className:"text-sm leading-relaxed",children:e.content})]})})]},e.id)})})})})]})]})}),t.jsx(x,{value:"milestones",className:"space-y-6",children:t.jsx(eh,{caseId:e.id,steps:e.workflowSteps||[],users:a,currentUser:s})}),(0,t.jsxs)(x,{value:"documents",className:"space-y-6",children:[t.jsx("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Case Documents"}),t.jsx("p",{className:"text-muted-foreground",children:"All files and documents related to this case"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.files.map(e=>t.jsx(i.Zb,{className:"hover:shadow-md transition-shadow",children:(0,t.jsxs)(i.aY,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[t.jsx(w.Z,{className:"w-10 h-10 text-blue-500"}),t.jsx(h.C,{variant:"secondary",className:"text-xs",children:e.mimeType.split("/")[1]?.toUpperCase()})]}),t.jsx("h3",{className:"font-semibold mb-2 truncate",title:e.originalName,children:e.originalName}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,t.jsxs)("p",{children:["Size: ",(e.fileSize/1024).toFixed(1)," KB"]}),(0,t.jsxs)("p",{children:["Uploaded by: ",e.uploadedBy.name]}),(0,t.jsxs)("p",{children:["Date: ",new Date(e.uploadedAt).toLocaleDateString()]})]}),t.jsx(r.z,{className:"w-full mt-3",variant:"outline",size:"sm",asChild:!0,children:t.jsx("a",{href:`/api/files/${e.fileName}`,download:!0,children:"Download"})})]})},e.id)),0===e.files.length&&(0,t.jsxs)("div",{className:"col-span-full text-center py-8 text-muted-foreground",children:[t.jsx(w.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No documents uploaded yet"}),t.jsx("p",{className:"text-sm",children:"Upload files from the main cases page"})]})]})]}),(0,t.jsxs)(x,{value:"time",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Time Tracking"}),t.jsx("p",{className:"text-muted-foreground",children:"Log hours worked on this case"})]}),t.jsx(U,{caseId:e.id})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[e.actualHours.toFixed(1),"h"]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Hours"})]}),t.jsx(y.Z,{className:"w-8 h-8 text-muted-foreground"})]})})}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold law-gold",children:["$",f.toLocaleString()]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Billable Amount"})]}),t.jsx(z.Z,{className:"w-8 h-8 text-muted-foreground"})]})})}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-2xl font-bold",children:e.timeEntries.length}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Time Entries"})]}),t.jsx(T.Z,{className:"w-8 h-8 text-muted-foreground"})]})})})]}),t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"p-0",children:(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("table",{className:"w-full",children:[t.jsx("thead",{className:"border-b",children:(0,t.jsxs)("tr",{className:"text-left",children:[t.jsx("th",{className:"p-4 font-semibold",children:"Date"}),t.jsx("th",{className:"p-4 font-semibold",children:"User"}),t.jsx("th",{className:"p-4 font-semibold",children:"Description"}),t.jsx("th",{className:"p-4 font-semibold",children:"Hours"}),t.jsx("th",{className:"p-4 font-semibold",children:"Rate"}),t.jsx("th",{className:"p-4 font-semibold",children:"Amount"}),t.jsx("th",{className:"p-4 font-semibold",children:"Billable"})]})}),t.jsx("tbody",{children:e.timeEntries.map(e=>(0,t.jsxs)("tr",{className:"border-b",children:[t.jsx("td",{className:"p-4",children:new Date(e.date).toLocaleDateString()}),t.jsx("td",{className:"p-4",children:e.user.name}),t.jsx("td",{className:"p-4",children:e.description||"-"}),(0,t.jsxs)("td",{className:"p-4",children:[e.hours,"h"]}),(0,t.jsxs)("td",{className:"p-4",children:["$",e.hourlyRate||"-"]}),(0,t.jsxs)("td",{className:"p-4",children:["$",e.amount||"-"]}),t.jsx("td",{className:"p-4",children:t.jsx(h.C,{variant:e.billable?"default":"secondary",children:e.billable?"Yes":"No"})})]},e.id))})]}),0===e.timeEntries.length&&(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(y.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No time entries recorded yet"}),t.jsx("p",{className:"text-sm",children:"Start tracking time to monitor case profitability"})]})]})})})]}),(0,t.jsxs)(x,{value:"legal",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Legal Research & References"}),t.jsx("p",{className:"text-muted-foreground",children:"Relevant statutes, case law, and legal resources"})]}),t.jsx(B,{caseId:e.id})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[e.legalRefs.map(e=>t.jsx(i.Zb,{children:(0,t.jsxs)(i.aY,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{children:[t.jsx(h.C,{variant:"outline",className:"mb-2",children:e.type.replace("_"," ").toUpperCase()}),t.jsx("h3",{className:"text-lg font-semibold",children:e.title}),t.jsx("p",{className:"text-sm text-muted-foreground",children:e.citation})]}),e.url&&t.jsx(r.z,{variant:"outline",size:"sm",asChild:!0,children:t.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:"View Source"})})]}),e.summary&&(0,t.jsxs)("div",{className:"mb-3",children:[t.jsx("h4",{className:"font-medium mb-1",children:"Summary"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:e.summary})]}),e.relevance&&(0,t.jsxs)("div",{className:"mb-3",children:[t.jsx("h4",{className:"font-medium mb-1",children:"Relevance to Case"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:e.relevance})]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Added by ",e.addedBy.name," on ",new Date(e.createdAt).toLocaleDateString()]})]})},e.id)),0===e.legalRefs.length&&(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx(C.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No legal references added yet"}),t.jsx("p",{className:"text-sm",children:"Add relevant statutes and case law to support your case"})]})]})]}),(0,t.jsxs)(x,{value:"activity",className:"space-y-6",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Case Activity Log"}),t.jsx("p",{className:"text-muted-foreground",children:"Complete history of all case actions"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[e.activities.map(e=>t.jsx(i.Zb,{children:t.jsx(i.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsxs)(p,{className:"w-8 h-8",children:[t.jsx(j,{src:e.user?.image||""}),t.jsx(g,{children:e.user?.name?.split(" ").map(e=>e[0]).join("").toUpperCase()||"SY"})]}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:e.description}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["by ",e.user?.name||"System"," • ",(0,F.Q)(new Date(e.createdAt),{addSuffix:!0})]})]})]}),t.jsx(h.C,{variant:"secondary",className:"text-xs",children:e.type.replace("_"," ")})]})})},e.id)),0===e.activities.length&&t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:t.jsx("p",{children:"No activities recorded yet"})})]})]})]})]})}},567:(e,s,a)=>{"use strict";a.d(s,{C:()=>d});var t=a(10326);a(17577);var l=a(28671),r=a(77863);let i=(0,l.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:s,...a}){return t.jsx("div",{className:(0,r.cn)(i({variant:s}),e),...a})}},33071:(e,s,a)=>{"use strict";a.d(s,{Ol:()=>d,SZ:()=>c,Zb:()=>i,aY:()=>o,eW:()=>m,ll:()=>n});var t=a(10326),l=a(17577),r=a(77863);let i=l.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let d=l.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));d.displayName="CardHeader";let n=l.forwardRef(({className:e,...s},a)=>t.jsx("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));n.displayName="CardTitle";let c=l.forwardRef(({className:e,...s},a)=>t.jsx("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let o=l.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,r.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent";let m=l.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s}));m.displayName="CardFooter"},53313:(e,s,a)=>{"use strict";a.d(s,{X:()=>n});var t=a(10326),l=a(17577),r=a(13635),i=a(32933),d=a(77863);let n=l.forwardRef(({className:e,...s},a)=>t.jsx(r.fC,{ref:a,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:t.jsx(r.z$,{className:(0,d.cn)("flex items-center justify-center text-current"),children:t.jsx(i.Z,{className:"h-4 w-4"})})}));n.displayName=r.fC.displayName},62288:(e,s,a)=>{"use strict";a.d(s,{$N:()=>u,Vq:()=>n,cZ:()=>x,fK:()=>h,hg:()=>c});var t=a(10326),l=a(17577),r=a(98958),i=a(94019),d=a(77863);let n=r.fC,c=r.xz,o=r.h_;r.x8;let m=l.forwardRef(({className:e,...s},a)=>t.jsx(r.aV,{ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));m.displayName=r.aV.displayName;let x=l.forwardRef(({className:e,children:s,...a},l)=>(0,t.jsxs)(o,{children:[t.jsx(m,{}),(0,t.jsxs)(r.VY,{ref:l,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a,children:[s,(0,t.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(i.Z,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));x.displayName=r.VY.displayName;let h=({className:e,...s})=>t.jsx("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});h.displayName="DialogHeader";let u=l.forwardRef(({className:e,...s},a)=>t.jsx(r.Dx,{ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));u.displayName=r.Dx.displayName,l.forwardRef(({className:e,...s},a)=>t.jsx(r.dk,{ref:a,className:(0,d.cn)("text-sm text-muted-foreground",e),...s})).displayName=r.dk.displayName},31048:(e,s,a)=>{"use strict";a.d(s,{_:()=>c});var t=a(10326),l=a(17577),r=a(34478),i=a(28671),d=a(77863);let n=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef(({className:e,...s},a)=>t.jsx(r.f,{ref:a,className:(0,d.cn)(n(),e),...s}));c.displayName=r.f.displayName},60064:(e,s,a)=>{"use strict";a.d(s,{Progress:()=>d});var t=a(10326),l=a(17577),r=a(87273),i=a(77863);let d=l.forwardRef(({className:e,value:s,...a},l)=>t.jsx(r.fC,{ref:l,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...a,children:t.jsx(r.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));d.displayName=r.fC.displayName},34474:(e,s,a)=>{"use strict";a.d(s,{Bw:()=>f,Ph:()=>o,Ql:()=>p,i4:()=>x,ki:()=>m});var t=a(10326),l=a(17577),r=a(18792),i=a(941),d=a(96633),n=a(32933),c=a(77863);let o=r.fC;r.ZA;let m=r.B4,x=l.forwardRef(({className:e,children:s,...a},l)=>(0,t.jsxs)(r.xz,{ref:l,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[s,t.jsx(r.JO,{asChild:!0,children:t.jsx(i.Z,{className:"h-4 w-4 opacity-50"})})]}));x.displayName=r.xz.displayName;let h=l.forwardRef(({className:e,...s},a)=>t.jsx(r.u_,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(d.Z,{className:"h-4 w-4"})}));h.displayName=r.u_.displayName;let u=l.forwardRef(({className:e,...s},a)=>t.jsx(r.$G,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(i.Z,{className:"h-4 w-4"})}));u.displayName=r.$G.displayName;let f=l.forwardRef(({className:e,children:s,position:a="popper",...l},i)=>t.jsx(r.h_,{children:(0,t.jsxs)(r.VY,{ref:i,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...l,children:[t.jsx(h,{}),t.jsx(r.l_,{className:(0,c.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(u,{})]})}));f.displayName=r.VY.displayName,l.forwardRef(({className:e,...s},a)=>t.jsx(r.__,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=r.__.displayName;let p=l.forwardRef(({className:e,children:s,...a},l)=>(0,t.jsxs)(r.ck,{ref:l,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(r.wU,{children:t.jsx(n.Z,{className:"h-4 w-4"})})}),t.jsx(r.eT,{children:s})]}));p.displayName=r.ck.displayName,l.forwardRef(({className:e,...s},a)=>t.jsx(r.Z0,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=r.Z0.displayName},87673:(e,s,a)=>{"use strict";a.d(s,{g:()=>i});var t=a(10326),l=a(17577),r=a(77863);let i=l.forwardRef(({className:e,...s},a)=>t.jsx("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));i.displayName="Textarea"},71815:(e,s,a)=>{"use strict";a.d(s,{_:()=>t});let t=(0,a(68570).createProxy)(String.raw`/Users/thinhledinh/Desktop/laware_crm_google/components/cases/case-detail-view.tsx#CaseDetailView`)}};